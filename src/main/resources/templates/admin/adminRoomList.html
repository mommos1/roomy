<th:block th:fragment="title">
    <title>객실 관리</title>
</th:block>

<th:block th:fragment="css">
    <link rel="stylesheet" href="/css/admin/adminStayList.css">
</th:block>

<th:block th:fragment="content">
    <section class="accommodation-section">
        <h2>객실 목록</h2>
        <button class="register-btn" th:onclick="'goRegRoom('+ ${stayId} +')'">+ 등록하기</button>

        <table class="accommodation-table">
            <thead>
            <tr>
                <th>번호</th>
                <th>객실 명</th>
                <th>최대 인원</th>
                <th>가격</th>
                <th>설명</th>
                <th>관리</th>
            </tr>
            </thead>
            <tbody>
            <th:block th:if="${adminRoomList != null and !#lists.isEmpty(adminRoomList)}">
                <tr th:each="room, iterStat : ${adminRoomList}">
                    <td th:text="${iterStat.index + 1}">1</td>
                    <td th:text="${room.name}">일반객실</td>
                    <td th:text="${room.capacity}">3명</td>
                    <td th:text="${room.pricePerNight}">30000 원</td>
                    <td th:text="${room.description}">침대1 TV1</td>
                    <td>
                        <button>수정</button>
                        <button th:onclick="'deleteRoom('+ ${room.id} +')'">삭제</button>
                    </td>
                </tr>
            </th:block>

            <tr th:if="${adminRoomList == null or #lists.isEmpty(adminRoomList)}">
                <td>데이터가 없습니다.</td>
            </tr>
            </tbody>
        </table>
    </section>

    <script>
        function goRegRoom(stayId) {
            location.href='/admin/room/regPage?stayId=' + stayId;
        }

        function deleteRoom(roomId) {
            $.ajax({
                url: "/admin/room/delete/room/" + roomId,
                type: "DELETE",
                success: function(data) {
                    alert("삭제가 완료되었습니다.");
                    location.reload();
                },
                error: function(xhr) {
                    alert("삭제 중 오류 발생: " + xhr.responseText);
                }
            });
        }
    </script>
</th:block>